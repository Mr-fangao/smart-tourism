

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> openlayers/layer/3rdLayer.js</title>

  <script src="../cdn/run_prettify.js"></script>
  <script src="../cdn/babel.min.js"></script>
  <script src="./build/entry.js"></script>
  <script src="../cdn/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="../cdn/googleapis.css" rel="stylesheet">
  <link href="../cdn/prettify.css" rel="stylesheet">
  <link rel="stylesheet" href="../cdn/all.css" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="../cdn/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="../cdn/mapgis.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="../cdn/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
             
                <a class="image" href="/">
                    <img class="mapgis-webclient-logo" src="../image/mapgis_blue.png" alt="logo">
                </a>
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    API
                </a>
                <div class="dropdown is-hoverable is-right">
                    <a class="dropdown-trigger link">
                        帮助向导
                    </a>
                    <div class="dropdown-menu">
                        <div class="dropdown-content">
                        
                            
                                <a class="dropdown-item" href="tutorial-1.快速入门.html">
                                    1.快速入门
                                </a>
                            
                        
                        </div>
                    </div>
                </div>
                 
                    
                        <a
                            class="link user-link "
                            href="/docs/cesium/index.html"
                        >
                            Cesium
                        </a>
                    
                        <a
                            class="link user-link "
                            href="/docs/mapboxgl/index.html"
                        >
                            MapboxGL
                        </a>
                    
                        <a
                            class="link user-link "
                            href="/docs/leaflet/index.html"
                        >
                            Leaflet
                        </a>
                    
                        <a
                            class="link user-link "
                            href="/docs/openlayers/index.html"
                        >
                            OpenLayers
                        </a>
                    
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            <div>
                <span class="mapgis-api-document-span"><a href="index.html">API文档</a></span>
            </div>
            
                <div class="search-wrapper">
                    <input id="search" type="text" placeholder="搜索文档..." class="input">
                </div>
            
            <nav>
                
                    <div class="category"><div class="mapgis-menu-span">模块</div><ul class="mapgis-sidebar-menus"><li><a href="module-ArcGis.html">ArcGis</a></li><li><a href="module-CloudDisk.html">CloudDisk</a></li><li><a href="module-DataStore.html">DataStore</a></li><li><a href="module-IGServerX.html">IGServerX</a></li><li><a href="module-OGC%25E6%259C%258D%25E5%258A%25A1.html">OGC服务</a></li><li><a href="module-ol_source_TileDebug.html">ol/source/TileDebug</a></li><li><a href="module-OpenGeospatialConsortium%25E6%259C%258D%25E5%258A%25A1.html">OpenGeospatialConsortium服务</a></li><li><a href="module-PostGIS.html">PostGIS</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.html">专题图服务</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.html">几何分析服务</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.html">分析服务</a></li><li><a href="module-%25E5%259C%25B0%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.html">地图服务</a></li><li><a href="module-%25E5%25AE%25A2%25E6%2588%25B7%25E7%25AB%25AF%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596.html">客户端可视化</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.html">弹性搜索服务</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.html">目录服务</a></li><li><a href="module-%25E7%259F%25A2%25E9%2587%258F%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE.html">矢量大数据</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.html">要素服务</a></li></ul><div class="mapgis-menu-span">类名</div><ul class="mapgis-sidebar-menus"><li><a href="Circle.html">Circle</a></li><li><a href="CoordinateElpTrans.html">CoordinateElpTrans</a></li><li><a href="Drag.html">Drag</a></li><li><a href="FunctionWareService.html">FunctionWareService</a></li><li><a href="goog.inherits-tempCtor.html">tempCtor</a></li><li><a href="ISocketService.html">ISocketService</a></li><li><a href="MilStd.event.MilStdDrawEvent.html">MilStdDrawEvent</a></li><li><a href="MilStdDragPan.html">MilStdDragPan</a></li><li><a href="MilStdDrawTool.html">MilStdDrawTool</a></li><li><a href="MilStdModifyTool.html">MilStdModifyTool</a></li><li><a href="module-ArcGis.ArcGisBaseParam.html">ArcGisBaseParam</a></li><li><a href="module-ArcGis.ArcGisExtent.html">ArcGisExtent</a></li><li><a href="module-ArcGis.ArcGisFeatureLayer.html">ArcGisFeatureLayer</a></li><li><a href="module-ArcGis.ArcGisFindTask.html">ArcGisFindTask</a></li><li><a href="module-ArcGis.ArcGisGraphic.html">ArcGisGraphic</a></li><li><a href="module-ArcGis.ArcGisIdentifyTask.html">ArcGisIdentifyTask</a></li><li><a href="module-ArcGis.ArcGisMultipoint.html">ArcGisMultipoint</a></li><li><a href="module-ArcGis.ArcGisPoint.html">ArcGisPoint</a></li><li><a href="module-ArcGis.ArcGisPolygon.html">ArcGisPolygon</a></li><li><a href="module-ArcGis.ArcGisPolyline.html">ArcGisPolyline</a></li><li><a href="module-ArcGis.ArcGisQuery.html">ArcGisQuery</a></li><li><a href="module-ArcGis.ArcGisServiceBase.html">ArcGisServiceBase</a></li><li><a href="module-ArcGis.ArcGisSpatialReference.html">ArcGisSpatialReference</a></li><li><a href="module-CloudDisk.CalculateModelService.html">CalculateModelService</a></li><li><a href="module-CloudDisk.CloudDiskService.html">CloudDiskService</a></li><li><a href="module-CloudDisk.GeoDatasetService.html">GeoDatasetService</a></li><li><a href="module-CloudDisk.GisCore.FileService.html">FileService</a></li><li><a href="module-CloudDisk.ToolsService.html">ToolsService</a></li><li><a href="module-CloudDisk.UserService.html">UserService</a></li><li><a href="module-DataStore.DataStoreService.html">DataStoreService</a></li><li><a href="module-DataStore.ServiceParameter.html">ServiceParameter</a></li><li><a href="module-IGServerX.IGServerXService.html">IGServerXService</a></li><li><a href="module-OGC%2525E6%25259C%25258D%2525E5%25258A%2525A1.OGCService.html">OGCService</a></li><li><a href="module-OGC%25E6%259C%258D%25E5%258A%25A1.OGCWMSInfo.html">OGCWMSInfo</a></li><li><a href="module-OGC%25E6%259C%258D%25E5%258A%25A1.OGCWMTSInfo.html">OGCWMTSInfo</a></li><li><a href="module-OGC%25E6%259C%258D%25E5%258A%25A1.WMS.html">WMS</a></li><li><a href="module-ol_source_TileDebug-LabeledTile.html">LabeledTile</a></li><li><a href="module-ol_source_TileDebug-ZDTileDebug.html">ZDTileDebug</a></li><li><a href="module-PostGIS.PostgisCatlogService.html">PostgisCatlogService</a></li><li><a href="module-PostGIS.PostgisCustomQueryService.html">PostgisCustomQueryService</a></li><li><a href="module-PostGIS.PostgisQueryService.html">PostgisQueryService</a></li><li><a href="module-PostGIS.PostgisTableService.html">PostgisTableService</a></li><li><a href="module-PostGIS.PostgisVectorTileService.html">PostgisVectorTileService</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CAllOtherDataItemInfoSource.html">CAllOtherDataItemInfoSource</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CAnnInfo.html">CAnnInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CChartLabelFormat.html">CChartLabelFormat</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CChartTheme.html">CChartTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CChartThemeInfo.html">CChartThemeInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CChartThemeRepresentInfo.html">CChartThemeRepresentInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CChartType.html">CChartType</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CDotDensityTheme.html">CDotDensityTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CFourColorTheme.html">CFourColorTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CGraduatedSymbolTheme.html">CGraduatedSymbolTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CLinInfo.html">CLinInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CMultiClassTheme.html">CMultiClassTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CPntInfo.html">CPntInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CRandomTheme.html">CRandomTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CRangeTheme.html">CRangeTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CRangeThemeInfo.html">CRangeThemeInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CRegInfo.html">CRegInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CSimpleTheme.html">CSimpleTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CTheme.html">CTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CThemeInfo.html">CThemeInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CUniqueTheme.html">CUniqueTheme</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.CUniqueThemeInfo.html">CUniqueThemeInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.ExpInfo.html">ExpInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.FolderInfo.html">FolderInfo</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.FolderInfoAttribute.html">FolderInfoAttribute</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.ItemValue.html">ItemValue</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.ThemeOper.html">ThemeOper</a></li><li><a href="module-%25E4%25B8%2593%25E9%25A2%2598%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.ThemesInfo.html">ThemesInfo</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.CalArea.html">CalArea</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.CalPolyLineLength.html">CalPolyLineLength</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.CalServiceBase.html">CalServiceBase</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.CProjectBySRSID.html">CProjectBySRSID</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.CProjectParam.html">CProjectParam</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.GeometryAnalysisBase.html">GeometryAnalysisBase</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ProjectDots.html">ProjectDots</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ProjectRang.html">ProjectRang</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.Smooth.html">Smooth</a></li><li><a href="module-%25E5%2587%25A0%25E4%25BD%2595%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.TopAnalysis.html">TopAnalysis</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.AnalysisBase.html">AnalysisBase</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ClassBufferBase.html">ClassBufferBase</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ClassBufferByMultiplyRing.html">ClassBufferByMultiplyRing</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ClassBufferBySingleRing.html">ClassBufferBySingleRing</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ClipBase.html">ClipBase</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ClipByCircle.html">ClipByCircle</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ClipByLayer.html">ClipByLayer</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ClipByPolygon.html">ClipByPolygon</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ContourAnalyse.html">ContourAnalyse</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.FeatureBuffBase.html">FeatureBuffBase</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.FeatureBuffByMultiplyRing.html">FeatureBuffByMultiplyRing</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.FeatureBuffBySingleRing.html">FeatureBuffBySingleRing</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.NetAnalysis.html">NetAnalysis</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.OverlayBase.html">OverlayBase</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.OverlayByLayer.html">OverlayByLayer</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.OverlayByPolygon.html">OverlayByPolygon</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ProjectBase.html">ProjectBase</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ProjectByLayer.html">ProjectByLayer</a></li><li><a href="module-%25E5%2588%2586%25E6%259E%2590%25E6%259C%258D%25E5%258A%25A1.ProjectBySRID.html">ProjectBySRID</a></li><li><a href="module-%25E5%259C%25B0%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.GetDocImageService.html">GetDocImageService</a></li><li><a href="module-%25E5%259C%25B0%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.GetLayerImageService.html">GetLayerImageService</a></li><li><a href="module-%25E5%259C%25B0%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.GetMapImageService.html">GetMapImageService</a></li><li><a href="module-%25E5%259C%25B0%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.GetMapInfoService.html">GetMapInfoService</a></li><li><a href="module-%25E5%259C%25B0%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.GetTileImageService.html">GetTileImageService</a></li><li><a href="module-%25E5%259C%25B0%25E5%259B%25BE%25E6%259C%258D%25E5%258A%25A1.MapServiceBase.html">MapServiceBase</a></li><li><a href="module-%25E5%25AE%25A2%25E6%2588%25B7%25E7%25AB%25AF%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596.MapvLayer.html">MapvLayer</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.EsCatlogService.html">EsCatlogService</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.ESGeoCode.html">ESGeoCode</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.EsGeocodeParameter.html">EsGeocodeParameter</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.EsGeocodeService.html">EsGeocodeService</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.ESGeoDecode.html">ESGeoDecode</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.ESQueryStats.html">ESQueryStats</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.EsSpaceTimeQueryByAgg.html">EsSpaceTimeQueryByAgg</a></li><li><a href="module-%25E5%25BC%25B9%25E6%2580%25A7%25E6%2590%259C%25E7%25B4%25A2%25E6%259C%258D%25E5%258A%25A1.EsTableService.html">EsTableService</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.CatalogService.html">CatalogService</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.ColorInfo.html">ColorInfo</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.GDBInfo.html">GDBInfo</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.MapDoc.html">MapDoc</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.SystomInfo.html">SystomInfo</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.TileLayer.html">TileLayer</a></li><li><a href="module-%25E7%259B%25AE%25E5%25BD%2595%25E6%259C%258D%25E5%258A%25A1.VectorLayer.html">VectorLayer</a></li><li><a href="module-%25E7%259F%25A2%25E9%2587%258F%25E5%25A4%25A7%25E6%2595%25B0%25E6%258D%25AE.SparkBufferService.html">SparkBufferService</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.EditDocFeature.html">EditDocFeature</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.EditLayerFeature.html">EditLayerFeature</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.EditServiceBase.html">EditServiceBase</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.MultiGeoQuery.html">MultiGeoQuery</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.MultiGeoQueryParameter.html">MultiGeoQueryParameter</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.ObjClsQuery.html">ObjClsQuery</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.ObjClsQueryParameter.html">ObjClsQueryParameter</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryByLayerParameter.html">QueryByLayerParameter</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryDocFeature.html">QueryDocFeature</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryFeatureRule.html">QueryFeatureRule</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryFeatureStruct.html">QueryFeatureStruct</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryLayerFeature.html">QueryLayerFeature</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryParameter.html">QueryParameter</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryParameterBase.html">QueryParameterBase</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryServiceBase.html">QueryServiceBase</a></li><li><a href="module-%25E8%25A6%2581%25E7%25B4%25A0%25E6%259C%258D%25E5%258A%25A1.QueryUnifyFeature.html">QueryUnifyFeature</a></li><li><a href="module=ArcGis.ArcGisFindParameters.html">ArcGisFindParameters</a></li><li><a href="module=ArcGis.ArcGisIdentifyParameters.html">ArcGisIdentifyParameters</a></li><li><a href="ol.zondy.MapvBaseLayer.html">MapvBaseLayer</a></li><li><a href="openlayers.zondy.MapvSource.html">MapvSource</a></li><li><a href="Zondy.Catalog.G3DMapDoc.html">G3DMapDoc</a></li><li><a href="Zondy.Catalog.G3DMapDoc_GetFeature.html">GetFeature</a></li><li><a href="Zondy.Catalog.G3DService.html">G3DService</a></li><li><a href="Zondy.Catalog.SystomInfo.html#GetSystemLibrary">GetSystemLibrary</a></li><li><a href="Zondy.Format.WMSCapabilities.html">WMSCapabilities</a></li><li><a href="Zondy.Format.WMTSCapabilities.html">WMTSCapabilities</a></li><li><a href="Zondy.Map.ArcGISLayer.html">ArcGISLayer</a></li><li><a href="Zondy.Map.BaiDuLayer.html">BaiDuLayer</a></li><li><a href="Zondy.Map.Doc.html">Doc</a></li><li><a href="Zondy.Map.GaoDeLayer.html">GaoDeLayer</a></li><li><a href="Zondy.Map.GdbpLayer.html">GdbpLayer</a></li><li><a href="Zondy.Map.GoogleLayer.html">GoogleLayer</a></li><li><a href="Zondy.Map.MapDocTileLayer.html">MapDocTileLayer</a></li><li><a href="Zondy.Map.OpenStreetLayer.html">OpenStreetLayer</a></li><li><a href="Zondy.Map.ThemeStyle.html">ThemeStyle</a></li><li><a href="Zondy.Map.TianDiTu.html">TianDiTu</a></li><li><a href="Zondy.Map.TileLayer.html">TileLayer</a></li><li><a href="Zondy.Object.AnyLine.html">AnyLine</a></li><li><a href="Zondy.Object.Arc.html">Arc</a></li><li><a href="Zondy.Object.CAttDataRow.html">CAttDataRow</a></li><li><a href="Zondy.Object.CAttStruct.html">CAttStruct</a></li><li><a href="Zondy.Object.CDisplayStyle.html">CDisplayStyle</a></li><li><a href="Zondy.Object.CDisplayStyleExtend.html">CDisplayStyleExtend</a></li><li><a href="Zondy.Object.CDynNoteInfo.html">CDynNoteInfo</a></li><li><a href="Zondy.Object.Circle.html">Circle</a></li><li><a href="Zondy.Object.CLineInfo.html">CLineInfo</a></li><li><a href="Zondy.Object.ContourAnalyse.ContourParam.html">ContourParam</a></li><li><a href="Zondy.Object.ContourAnalyse.MeshingParam.html">MeshingParam</a></li><li><a href="Zondy.Object.ContourAnalyse.SlopLineParam.html">SlopLineParam</a></li><li><a href="Zondy.Object.CPointInfo.html">CPointInfo</a></li><li><a href="Zondy.Object.CRegionInfo.html">CRegionInfo</a></li><li><a href="Zondy.Object.DynNoteLableType.html">DynNoteLableType</a></li><li><a href="Zondy.Object.DynShowStyle.html">DynShowStyle</a></li><li><a href="Zondy.Object.Feature.html">Feature</a></li><li><a href="Zondy.Object.FeatureGeometry.html">FeatureGeometry</a></li><li><a href="Zondy.Object.FeatureGraphicBase.html">FeatureGraphicBase</a></li><li><a href="Zondy.Object.FeatureSet.html">FeatureSet</a></li><li><a href="Zondy.Object.GLine.html">GLine</a></li><li><a href="Zondy.Object.GPoint.html">GPoint</a></li><li><a href="Zondy.Object.GRegion.html">GRegion</a></li><li><a href="Zondy.Object.LabelLinInfo.html">LabelLinInfo</a></li><li><a href="Zondy.Object.LabelRegInfo.html">LabelRegInfo</a></li><li><a href="Zondy.Object.LablePntInfo.html">LablePntInfo</a></li><li><a href="Zondy.Object.MultiPolygon.html">MultiPolygon</a></li><li><a href="Zondy.Object.Point2D.html">Point2D</a></li><li><a href="Zondy.Object.Polygon.html">Polygon</a></li><li><a href="Zondy.Object.PolyLine.html">PolyLine</a></li><li><a href="Zondy.Object.Rectangle.html">Rectangle</a></li><li><a href="Zondy.Object.Tangram.html">Tangram</a></li><li><a href="Zondy.Object.VectCls.html">VectCls</a></li><li><a href="Zondy.Object.WebGraphicsInfo.html">WebGraphicsInfo</a></li><li><a href="Zondy.Service.ServiceBase.html">ServiceBase</a></li><li><a href="Zondy.Source.ArcGISMapSource.html">ArcGISMapSource</a></li><li><a href="Zondy.Source.BaiduMapSource.html">BaiduMapSource</a></li><li><a href="Zondy.Source.GaodeMapSource.html">GaodeMapSource</a></li><li><a href="Zondy.Source.GeoFeatureSource.html">GeoFeatureSource</a></li><li><a href="Zondy.Source.GoogleMapSource.html">GoogleMapSource</a></li><li><a href="Zondy.Source.GraphThemeSource.html">GraphThemeSource</a></li><li><a href="Zondy.Source.OpenStreetMapSource.html">OpenStreetMapSource</a></li><li><a href="Zondy.Source.RandomThemeSource.html">RandomThemeSource</a></li><li><a href="Zondy.Source.RangeThemeSource.html">RangeThemeSource</a></li><li><a href="Zondy.Source.RankSymbolThemeSource.html">RankSymbolThemeSource</a></li><li><a href="Zondy.Source.SimpleThemeSource.html">SimpleThemeSource</a></li><li><a href="Zondy.Source.ThemeSource.html">ThemeSource</a></li><li><a href="Zondy.Source.TiandituMapSource.html">TiandituMapSource</a></li><li><a href="Zondy.Source.UniqueThemeSource.html">UniqueThemeSource</a></li></ul><div class="mapgis-menu-span">全局</div><ul class="mapgis-sidebar-menus"><li><a href="global.html#@private">@private</a></li><li><a href="global.html#ArcGISLayerType">ArcGISLayerType</a></li><li><a href="global.html#BroadcastEvent">BroadcastEvent</a></li><li><a href="global.html#CItemType">CItemType</a></li><li><a href="global.html#CLinAdjustType">CLinAdjustType</a></li><li><a href="global.html#CLinHeadType">CLinHeadType</a></li><li><a href="global.html#CLinJointType">CLinJointType</a></li><li><a href="global.html#CLinStyleMakeType">CLinStyleMakeType</a></li><li><a href="global.html#copyProperties">copyProperties</a></li><li><a href="global.html#custom">custom</a></li><li><a href="global.html#DEBUG">DEBUG</a></li><li><a href="global.html#domain">domain</a></li><li><a href="global.html#EightDirType">EightDirType</a></li><li><a href="global.html#EsCatlogName">EsCatlogName</a></li><li><a href="global.html#EsCatlogType">EsCatlogType</a></li><li><a href="global.html#EsGeoHashType">EsGeoHashType</a></li><li><a href="global.html#f">f</a></li><li><a href="global.html#FeatureType">FeatureType</a></li><li><a href="global.html#filters">filters</a></li><li><a href="global.html#FontShape">FontShape</a></li><li><a href="global.html#gdbps">gdbps</a></li><li><a href="global.html#goog">goog</a></li><li><a href="global.html#GoogleLayerType">GoogleLayerType</a></li><li><a href="global.html#headHeightFactor">headHeightFactor</a></li><li><a href="global.html#headWidthFactor">headWidthFactor</a></li><li><a href="global.html#How">How</a></li><li><a href="global.html#interpolateLagrange">interpolateLagrange</a></li><li><a href="global.html#ip">ip</a></li><li><a href="global.html#isAntialiasing">isAntialiasing</a></li><li><a href="global.html#ISShowArc">ISShowArc</a></li><li><a href="global.html#LabelLinType">LabelLinType</a></li><li><a href="global.html#LabelPntType">LabelPntType</a></li><li><a href="global.html#LabelRegType">LabelRegType</a></li><li><a href="global.html#LabelSpreadType">LabelSpreadType</a></li><li><a href="global.html#LayerEvent">LayerEvent</a></li><li><a href="global.html#layers">layers</a></li><li><a href="global.html#LayerStatusType">LayerStatusType</a></li><li><a href="global.html#LineConstrain">LineConstrain</a></li><li><a href="global.html#LOCALE">LOCALE</a></li><li><a href="global.html#mapstyOption">mapstyOption</a></li><li><a href="global.html#mapstyUri">mapstyUri</a></li><li><a href="global.html#MapType">MapType</a></li><li><a href="global.html#maxResolution">maxResolution</a></li><li><a href="global.html#maxZoom">maxZoom</a></li><li><a href="global.html#minZoom">minZoom</a></li><li><a href="global.html#mix">mix</a></li><li><a href="global.html#name">name</a></li><li><a href="global.html#neckHeightFactor">neckHeightFactor</a></li><li><a href="global.html#neckWidthFactor">neckWidthFactor</a></li><li><a href="global.html#NetAnalyType">NetAnalyType</a></li><li><a href="global.html#NetElemType">NetElemType</a></li><li><a href="global.html#networkProtocol">networkProtocol</a></li><li><a href="global.html#objectStack%255Bundefined%255D">objectStack[undefined]</a></li><li><a href="global.html#OpenStreetLayerType">OpenStreetLayerType</a></li><li><a href="global.html#origin">origin</a></li><li><a href="global.html#PARAM_BRACKET_LEFT">PARAM_BRACKET_LEFT</a></li><li><a href="global.html#PARAM_BRACKET_RIGHT">PARAM_BRACKET_RIGHT</a></li><li><a href="global.html#PARAM_COMMA">PARAM_COMMA</a></li><li><a href="global.html#PARAM_SPACE">PARAM_SPACE</a></li><li><a href="global.html#PARAM_SPLIT">PARAM_SPLIT</a></li><li><a href="global.html#PARAM_SUB">PARAM_SUB</a></li><li><a href="global.html#Path">Path</a></li><li><a href="global.html#port">port</a></li><li><a href="global.html#proj">proj</a></li><li><a href="global.html#RepeatType">RepeatType</a></li><li><a href="global.html#rlt">rlt</a></li><li><a href="global.html#SPACE_ENUM_POLYGON">SPACE_ENUM_POLYGON</a></li><li><a href="global.html#style">style</a></li><li><a href="global.html#SubscribeEvent">SubscribeEvent</a></li><li><a href="global.html#tailWidthFactor">tailWidthFactor</a></li><li><a href="global.html#TiandituType">TiandituType</a></li><li><a href="global.html#tileOriginType">tileOriginType</a></li><li><a href="global.html#tileSize">tileSize</a></li><li><a href="global.html#tileUrlFunction">tileUrlFunction</a></li><li><a href="global.html#token">token</a></li><li><a href="global.html#TotalCount">TotalCount</a></li><li><a href="global.html#v2Equal">v2Equal</a></li><li><a href="global.html#VectClsType">VectClsType</a></li><li><a href="global.html#Whether">Whether</a></li><li><a href="global.html#XClsType">XClsType</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <span class="page-title-sub">openlayers/layer/3rdLayer.js</span>
                    <span class="page-title-main">Source</span>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>﻿/// &lt;summary>
/// 第三方数据
/// &lt;/summary>

import {Zondy} from '../../service/common/Base';
import {newGuid} from '../../service/common/Util';
import TileImage
    from 'ol/source/TileImage.js';
import * as ol_extent
    from 'ol/extent.js';
import TileGrid
    from 'ol/tilegrid/TileGrid.js';
import {inherits} from 'ol/util.js';
import TileLayer
    from 'ol/layer/Tile.js';
import * as ol_proj
    from 'ol/proj.js';

/**
 * 百度地图资源构造函数
 * @class Zondy.Source.BaiduMapSource
 * @classdesc extent(图层范围)必须设置，origin(瓦片原点)如果不赋值则默认取[0，0]
 * @extends Zondy.Source.BaiduMapSource
 *
 * @param {Object} option 属性键值对
 * @param {String} [option.attributions = null] 基本描述内容
 * @param {String} [option.logo = null] 基本描述图标Logo
 * @param {String} [option.opaque = null] 不透明度
 * @param {String} [option.projection = null] ol.proj
 * @param {String} [option.state = undefined] 状态
 * @param {String} [option.tilePixelRatio = ] 瓦片的像素分辨率
 * @param {Boolean} [option.wrapX = false] 通过wrapX:false限制图层在x轴方向重复
 * @param {String} [option.crossOrigin = null] crossOrigin="anonymous"为跨域调用
 */
var BaiduMapSource = function (option) {
    var options = option !== undefined ? option : {};
    TileImage.call(this, {
        attributions: options.attributions,
        logo: options.logo,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state !== undefined ? options.state : undefined,
        tilePixelRatio: options.tilePixelRatio,
        wrapX: options.wrapX,
        crossOrigin: options.crossOrigin !== undefined ? options.crossOrigin : null
    });

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.maxResolution
     * @type {Number}
     * @description 最大分辨率,新瓦片必须指定
     * @default null
     */
    this.maxResolution = options.maxResolution !== undefined ? options.maxResolution : null;

    //根据投影获取地图范围
    var tileProjection = options.projection !== undefined ? options.projection : null;

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.tileExtent
     * @type {Array}
     * @description 瓦片范围 [-20037508.34, -20037508.34, 20037508.34, 20037508.34]
     * @default [-20037508.34, -20037508.34, 20037508.34, 20037508.34]
     */
    this.tileExtent = [-180, -90, 180, 90];
    if (tileProjection != null) {
        this.tileExtent = tileProjection.getExtent();
    } else {
        this.tileExtent = [-20037508.34, -20037508.34, 20037508.34, 20037508.34];
    }

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.extent
     * @type {Array}
     * @description 地图范围 options.extent 或者 this.tileExtent
     * @default null
     */
    this.extent = options.extent !== undefined ? options.extent : this.tileExtent;

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.origin
     * @type {Array}
     * @description 地图的原点，可由外部指定,默认左上角 Array&lt;Number> [0, 0]
     * @default [0, 0]
     */
    this.origin = options.origin !== undefined ? options.origin : [0, 0];

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.maxZoom
     * @type {Number}
     * @description 瓦片地图总级数
     * @default 16
     */
    this.maxZoom = options.maxZoom !== undefined ? options.maxZoom : 16;

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.tileSize
     * @type {Number}
     * @description 地图图片大小
     * @default 256
     */
    this.tileSize = options.tileSize !== undefined ? options.tileSize : 256;

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.resolutions
     * @type {Number}
     * @description 分辨率数组，根据传入的分辨率或范围计算得到
     * @see Zondy.Source.BaiduMapSource.prototype.getResolutions
     */
    this.resolutions = this.getResolutions();

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.tileGrid
     * @private
     * @type {Object}
     * @description 创建网格(内部调用){@link ol.TileGrid}
     * @example
     * this.tileGrid = new TileGrid({
            origin: this.origin, //数组类型，如[0,0],
            resolutions: this.resolutions, //分辨率
            tileSize: this.tileSize //瓦片图片大小
        });
     */
    this.tileGrid = new TileGrid({
        origin: this.origin, //数组类型，如[0,0],
        resolutions: this.resolutions, //分辨率
        tileSize: this.tileSize //瓦片图片大小
    });

    /**
     * @member Zondy.Source.BaiduMapSource.prototype.tileUrlFunction
     * @protected
     * @type {ol.TileUrlFunctionType}
     * @description 拼接取图地址方法
     * @default this.tileUrlFunctionExtend
     */
    this.tileUrlFunction = options.tileUrlFunction !== undefined ? options.tileUrlFunction : this.tileUrlFunctionExtend;

};
inherits(BaiduMapSource, TileImage);

/**
 * @function Zondy.Source.BaiduMapSource.prototype.getResolutions
 * @description 创建分辨率数组
 * @return {Array} opt_resolutions
 */
BaiduMapSource.prototype.getResolutions = function () {
    if (this.maxResolution == null) {
        var width = ol_extent.getWidth(this.tileExtent);
        var height = ol_extent.getHeight(this.tileExtent);
        this.maxResolution = (width >= height ? height : width) / (this.tileSize);
    }
    var opt_resolutions = new Array(this.maxZoom);
    for (var z = 0; z &lt; this.maxZoom; ++z) {
        opt_resolutions[z] = this.maxResolution / Math.pow(2, z);
    }
    return opt_resolutions;
};

/**
 * @function Zondy.Source.BaiduMapSource.prototype.tileUrlFunctionExtend
 * @description 拼接url取图地址
 * @param {Array.&lt;number>} tileCoord 数据格式包含级数、行号、列号.
 * @param {String} pixelRatio 像素比率
 * @param {ol.proj.Projection} projection 投影
 * @return {String} 替换x-y-z后的url地址
 */
BaiduMapSource.prototype.tileUrlFunctionExtend = function (tileCoord, pixelRatio, projection) {
    //判断返回的当前级数的行号和列号是否包含在整个地图范围内
    if (this.tileGrid != null) {
        var tileRange = this.tileGrid.getTileRangeForExtentAndZ(this.extent, tileCoord[0], tileRange);
        if (!tileRange.contains(tileCoord)) {
            return;
        }
    }
    var urlTemplate = "http://online2.map.bdimg.com/tile/?qt=tile&amp;x=" + '{x}' + "&amp;y=" + '{y}' + "&amp;z=" + '{z}' + "&amp;styles=pl&amp;udt=20141219&amp;scaler=1";
    var z = tileCoord[0];
    var x = tileCoord[1];
    var y = tileCoord[2];
    return urlTemplate.replace('{z}', z.toString()).replace('{y}', y.toString()).replace('{x}', x.toString());
};

export {BaiduMapSource};
Zondy.Source.BaiduMapSource = BaiduMapSource;

/**
 * 百度地图资源构造函数
 * @class Zondy.Map.BaiDuLayer
 * @classdesc 显示百度地图的功能服务构造函数
 *
 * @param {Object} option 属性键值对
 * @param {Zondy.Source.BaiduMapSource} [option.source = null] openlayer的地图source
 */
var BaiDuLayer = function (option) {
    var options = option !== undefined ? option : {};
    TileLayer.call(this, options);
    if (options.source == undefined) {
        this.source = new BaiduMapSource(options);
        this.setSource(this.source);
    }
};
inherits(BaiDuLayer, TileLayer);

export {BaiDuLayer};
Zondy.Map.BaiDuLayer = BaiDuLayer;

/**
 * @class Zondy.Source.GaodeMapSource
 * @classdesc 高德地图资源构造函数, extent(图层范围)必须设置，origin(瓦片原点)如果不赋值则默认取图层范围的左上角
 *
 * @param {Object} option 属性键值对
 * @param {String} [option.attributions = null] 基本描述内容
 * @param {String} [option.logo = null] 基本描述图标Logo
 * @param {String} [option.opaque = null] 不透明度
 * @param {String} [option.projection = null] ol.proj
 * @param {String} [option.state = undefined] 状态
 * @param {String} [option.tilePixelRatio = ] 瓦片的像素分辨率
 * @param {Boolean} [option.wrapX = false] 通过wrapX:false限制图层在x轴方向重复
 * @param {String} [option.crossOrigin = null] crossOrigin="anonymous"为跨域调用
 */
var GaodeMapSource = function (option) {
    var options = option !== undefined ? option : {};
    TileImage.call(this, {
        attributions: options.attributions,
        logo: options.logo,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state !== undefined ? options.state : undefined,
        tilePixelRatio: options.tilePixelRatio,
        wrapX: options.wrapX,
        crossOrigin: options.crossOrigin !== undefined ? options.crossOrigin : null  //"anonymous"为跨域调用,
    });

    /**
     * @public
     * @member Zondy.Source.GaodeMapSource.prototype.maxResolution
     * @type {Number}
     * @description 最大分辨率,新瓦片必须指定
     * @default null
     */
    this.maxResolution = null;

    //根据投影获取地图范围
    var tileProjection = options.projection !== undefined ? options.projection : null;

    /**
     * @member Zondy.Source.GaodeMapSource.prototype.tileExtent
     * @type {Array}
     * @description 瓦片范围 [-20037508.34, -20037508.34, 20037508.34, 20037508.34]
     * @default [-20037508.34, -20037508.34, 20037508.34, 20037508.34]
     */
    this.tileExtent = [-180, -90, 180, 90];

    if (tileProjection != null) {
        this.tileExtent = tileProjection.getExtent();
    } else {
        this.tileExtent = [-20037508.34, -20037508.34, 20037508.34, 20037508.34];
    }

    /**
     * @member Zondy.Source.GaodeMapSource.prototype.extent
     * @type {Array}
     * @description 地图范围 options.extent 或者 this.tileExtent
     * @default this.tileExtent
     */
    this.extent = options.extent !== undefined ? options.extent : this.tileExtent;

    /**
     * @public
     * @member Zondy.Source.GaodeMapSource.prototype.origin
     * @type {Array}
     * @description 地图的原点，可由外部指定,默认左上角 Array&lt;Number> [0, 0]
     * @default ol_extent.getTopLeft(this.extent)
     */
    this.origin = options.origin !== undefined ? options.origin : ol_extent.getTopLeft(this.extent);

    /**
     * @public
     * @member Zondy.Source.GaodeMapSource.prototype.maxZoom
     * @type {Number}
     * @description 瓦片地图总级数
     * @default 16
     */
    this.maxZoom = options.maxZoom !== undefined ? (options.maxZoom &lt;= 18 ? options.maxZoom : 18) : 18;

    /**
     * @public
     * @member Zondy.Source.GaodeMapSource.prototype.tileSize
     * @type {Number}
     * @description 地图图片大小
     * @default 256
     */
    this.tileSize = options.tileSize !== undefined ? options.tileSize : 256;

    /**
     * @member Zondy.Source.GaodeMapSource.prototype.resolutions
     * @type {Number}
     * @description 分辨率数组，根据传入的分辨率或范围计算得到
     * @see Zondy.Source.GaodeMapSource.prototype.getResolutions
     */
    this.resolutions = this.getResolutions();

    /**
     * @member Zondy.Source.GaodeMapSource.prototype.tileGrid
     * @private
     * @type {Object}
     * @description 创建网格(内部调用){@link ol.TileGrid}
     * @example
     * this.tileGrid = new TileGrid({
            origin: this.origin, //数组类型，如[0,0],
            resolutions: this.resolutions, //分辨率
            tileSize: this.tileSize //瓦片图片大小
        });
     */
    this.tileGrid = new TileGrid({
        origin: this.origin, //数组类型，如[0,0],
        resolutions: this.resolutions, //分辨率
        tileSize: this.tileSize //瓦片图片大小
    });

    /**
     * @member Zondy.Source.GaodeMapSource.prototype.tileUrlFunction
     * @protected
     * @type {ol.TileUrlFunctionType}
     * @description 拼接取图地址方法
     * @default this.tileUrlFunctionExtend
     */
    this.tileUrlFunction = options.tileUrlFunction !== undefined ? options.tileUrlFunction : this.tileUrlFunctionExtend;

};
inherits(GaodeMapSource, TileImage);

/**
 * @function Zondy.Source.GaodeMapSource.prototype.getResolutions
 * @description 创建分辨率数组
 * @return {Array} opt_resolutions
 */
GaodeMapSource.prototype.getResolutions = function () {
    if (this.maxResolution == null) {
        var width = ol_extent.getWidth(this.tileExtent);
        var height = ol_extent.getHeight(this.tileExtent);
        this.maxResolution = (width >= height ? height : width) / (this.tileSize);
    }
    var opt_resolutions = new Array(this.maxZoom);
    for (var z = 0; z &lt; this.maxZoom; ++z) {
        opt_resolutions[z] = this.maxResolution / Math.pow(2, z);
    }
    return opt_resolutions;
};

/**
 * @function Zondy.Source.GaodeMapSource.prototype.tileUrlFunctionExtend
 * @description 拼接url取图地址
 * @param {Array.&lt;number>} tileCoord 数据格式包含级数、行号、列号.
 * @param {String} pixelRatio 像素比率
 * @param {ol.proj.Projection} projection 投影
 * @return {String} 替换x-y-z后的url地址
 */
GaodeMapSource.prototype.tileUrlFunctionExtend = function (tileCoord, pixelRatio, projection) {
    //判断返回的当前级数的行号和列号是否包含在整个地图范围内
    if (this.tileGrid != null) {
        var tileRange = this.tileGrid.getTileRangeForExtentAndZ(this.extent, tileCoord[0], tileRange);
        if (!tileRange.contains(tileCoord)) {
            return;
        }
    }
    var urlTemplate = [
        "http://webrd01.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;scale=1&amp;style=7" + "&amp;z=" + '{z}' + "&amp;y=" + '{y}' + "&amp;x=" + '{x}',
        "http://webrd02.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;scale=1&amp;style=7" + "&amp;z=" + '{z}' + "&amp;y=" + '{y}' + "&amp;x=" + '{x}',
        "http://webrd03.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;scale=1&amp;style=7" + "&amp;z=" + '{z}' + "&amp;y=" + '{y}' + "&amp;x=" + '{x}',
        "http://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&amp;size=1&amp;scale=1&amp;style=7" + "&amp;z=" + '{z}' + "&amp;y=" + '{y}' + "&amp;x=" + '{x}'
    ];

    var z = tileCoord[0];
    var x = tileCoord[1];
    var y = -(tileCoord[2] + 1);
    return urlTemplate[Math.round(Math.random() * (urlTemplate.length - 1))].replace('{z}', z.toString())
        .replace('{y}', y.toString())
        .replace('{x}', x.toString());

};

export {GaodeMapSource};
Zondy.Source.GaodeMapSource = GaodeMapSource;

/**
 * 显示高德地图的功能服务
 * @class Zondy.Map.GaoDeLayer
 * @classdesc 显示百度地图的功能服务构造函数
 *
 * @param {Object} option 属性键值对
 * @param {Zondy.Source.GaodeMapSource} [option.source = null] openlayer的地图source
 */
var GaoDeLayer = function (option) {
    var options = option !== undefined ? option : {};
    TileLayer.call(this, options);
    if (options.source == undefined) {
        this.source = new GaodeMapSource(options);
        this.setSource(this.source);
    }
};
inherits(GaoDeLayer, TileLayer);

export {GaoDeLayer};
Zondy.Map.GaoDeLayer = GaoDeLayer;


/**
 * @class Zondy.Source.TiandituMapSource
 * @classdesc 天地图资源构造函数, extent(图层范围)必须设置，origin(瓦片原点)如果不赋值则默认取图层范围的左上角
 *
 * @param {Object} option 属性键值对
 * @param {String} [option.attributions = null] 基本描述内容
 * @param {String} [option.logo = null] 基本描述图标Logo
 * @param {String} [option.opaque = null] 不透明度
 * @param {String} [option.projection = null] ol.proj
 * @param {String} [option.state = undefined] 状态
 * @param {String} [option.tilePixelRatio = ] 瓦片的像素分辨率
 * @param {Boolean} [option.wrapX = false] 通过wrapX:false限制图层在x轴方向重复
 * @param {String} [option.crossOrigin = null] crossOrigin="anonymous"为跨域调用
 */
var TiandituMapSource = function (option) {
    var options = option !== undefined ? option : {};
    TileImage.call(this, {
        attributions: options.attributions,
        logo: options.logo,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state !== undefined ? options.state : undefined,
        tilePixelRatio: options.tilePixelRatio,
        wrapX: options.wrapX,
        crossOrigin: options.crossOrigin !== undefined ? options.crossOrigin : null  //"anonymous"为跨域调用,
    });

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.layerType
     * @type {TiandituType}
     * @description layerType(图层类型)，默认情况下为"vec" {@link Zondy.Enum.Map.TiandituType}
     * @default Zondy.Enum.Map.TiandituType.VEC
     */
    this.layerType = options.layerType !== undefined ? options.layerType : Zondy.Enum.Map.TiandituType.VEC;

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.ip
     * @type {String}
     * @description ip地址
     * @default null
     */
    this.ip = options.ip !== undefined ? options.ip : "127.0.0.1";

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.port
     * @type {Number}
     * @description port端口号
     * @default null
     */
    this.port = options.port !== undefined ? options.port : "6163";

    /**
     * @public
     * @type {string}
     * 请求使用的网格协议，默认http协议
     */
    this.networkProtocol = options.networkProtocol !== undefined ? options.networkProtocol : location.protocol.split(":")[0] || "http";

    /**
     * @public
     * @type {string}
     * 请求使用的域名，基地址
     */
    this.domain = options &amp;&amp; options.domain ? options.domain : '';

    if (this.domain === '') {
        this.domainStr = this.networkProtocol + '://' + this.ip + ':' + this.port;
    } else {
        this.domainStr = this.domain;
    }

    /**
     * @public
     * @member Zondy.Source.TiandituMapSource.prototype.maxResolution
     * @type {Number}
     * @description 最大分辨率,新瓦片必须指定
     * @default null
     */
    this.maxResolution = null;

    //根据投影获取地图范围
    var tileProjection = options.projection !== undefined ? options.projection : null;

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.tileExtent
     * @type {Array}
     * @description 瓦片范围 [-180, -90, 180, 90]
     * @default [-180, -90, 180, 90]
     */
    this.tileExtent = [-180, -90, 180, 90];
    if (tileProjection != null) {
        this.tileExtent = tileProjection.getExtent();
    }

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.extent
     * @type {Array}
     * @description 设置地图范围 options.extent 或者 this.tileExtent
     * @default this.tileExtent
     */
    this.extent = options.extent !== undefined ? options.extent : this.tileExtent;

    /**
     * @public
     * @member Zondy.Source.TiandituMapSource.prototype.origin
     * @type {Array}
     * @description 地图的原点，可由外部指定,默认左上角 Array&lt;Number> [0, 0]
     * @default ol_extent.getTopLeft(this.extent)
     */
    this.origin = options.origin !== undefined ? options.origin : ol_extent.getTopLeft(this.extent);//ol_extent.getBottomLeft(this.extent);

    /**
     * @public
     * @member Zondy.Source.TiandituMapSource.prototype.maxZoom
     * @type {Number}
     * @description 瓦片地图总级数
     * @default 18
     */
    this.maxZoom = options.maxZoom !== undefined ? (options.maxZoom &lt;= 18 ? options.maxZoom : 18) : 18;

    /**
     * @public
     * @member Zondy.Source.TiandituMapSource.prototype.tileSize
     * @type {Number}
     * @description 地图图片大小
     * @default 256
     */
    this.tileSize = options.tileSize !== undefined ? options.tileSize : 256;

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.resolutions
     * @type {Number}
     * @description 分辨率数组，根据传入的分辨率或范围计算得到
     * @see Zondy.Source.GaodeMapSource.prototype.getResolutions
     */
    this.resolutions = this.getResolutions();

    /**
     * @public
     * @type {object}
     * 自定义天地图
     * @param layer {String} 图层名称
     * @param baseUrl {string} 基地址
     * @param version {string} 版本
     */
    this.custom = options.custom !== undefined ? options.custom : null;

    /**
     * @public
     * @type {string}
     * 天地图取图token
     */
    this.token = options.token;

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.tileGrid
     * @private
     * @type {Object}
     * @description 创建网格(内部调用){@link ol.TileGrid}
     * @example
     * this.tileGrid = new TileGrid({
            origin: this.origin, //数组类型，如[0,0],
            resolutions: this.resolutions, //分辨率
            tileSize: this.tileSize //瓦片图片大小
        });
     */
    this.tileGrid = new TileGrid({
        origin: this.origin, //数组类型，如[0,0],
        resolutions: this.resolutions, //分辨率
        tileSize: this.tileSize //瓦片图片大小
    });

    /**
     * @member Zondy.Source.TiandituMapSource.prototype.tileUrlFunction
     * @protected
     * @type {ol.TileUrlFunctionType}
     * @description 拼接取图地址方法
     * @default this.tileUrlFunctionExtend
     */
    this.tileUrlFunction = options.tileUrlFunction !== undefined ? options.tileUrlFunction : this.tileUrlFunctionExtend;

};
inherits(TiandituMapSource, TileImage);

/**
 * @function Zondy.Source.TiandituMapSource.prototype.getResolutions
 * @description 创建分辨率数组
 * @return {Array} opt_resolutions
 */
TiandituMapSource.prototype.getResolutions = function () {
    if (this.maxResolution == null) {
        var width = ol_extent.getWidth(this.tileExtent);
        var height = ol_extent.getHeight(this.tileExtent);
        this.maxResolution = (width &lt;= height ? height : width) / (this.tileSize);
    }
    var opt_resolutions = new Array(this.maxZoom);
    for (var z = 0; z &lt; this.maxZoom; ++z) {
        opt_resolutions[z] = this.maxResolution / Math.pow(2, z);
    }
    return opt_resolutions;
};

/**
 * @function Zondy.Source.TiandituMapSource.prototype.tileUrlFunctionExtend
 * @description 拼接url取图地址
 * @param {Array.&lt;number>} tileCoord 数据格式包含级数、行号、列号.
 * @param {String} pixelRatio 像素比率
 * @param {ol.proj.Projection} projection 投影
 * @return {String} 替换x-y-z后的url地址
 */
TiandituMapSource.prototype.tileUrlFunctionExtend = function (tileCoord, pixelRatio, projection) {
    //判断返回的当前级数的行号和列号是否包含在整个地图范围内
    if (this.tileGrid != null) {
        var tileRange = this.tileGrid.getTileRangeForExtentAndZ(this.extent, tileCoord[0], tileRange);
        if (!tileRange.contains(tileCoord)) {
            return;
        }
    }
    var urlTemplate = "";
    if (this.custom !== null &amp;&amp; this.custom !== undefined) {
        if (this.custom.baseURL === undefined) {
            return;
        }
        this.custom.layer = this.custom.layer ? this.custom.layer : Zondy.Enum.Map.TiandituType.VEC;
        this.custom.version = this.custom.version ? this.custom.version : "1.0.0";
        // urlTemplate = this.custom.baseURL + "?SERVICE=WMTS&amp;REQUEST=GetTile&amp;VERSION=" + this.custom.version + "&amp;LAYER=" + this.custom.type + "&amp;STYLE=default&amp;TILEMATRIXSET=c&amp;FORMAT=tiles" + "&amp;TILECOL=" + '{x}' + "&amp;TILEROW=" + '{y}' + "&amp;TILEMATRIX=" + '{z}';
        if (this.custom.baseURL.indexOf("?") > 0)
            urlTemplate = this.custom.baseURL + "&amp;SERVICE=WMTS&amp;REQUEST=GetTile&amp;VERSION=" + this.custom.version + "&amp;LAYER=" + this.custom.layer + "&amp;STYLE=default&amp;TILEMATRIXSET=c&amp;FORMAT=tiles" + "&amp;TILECOL=" + '{x}' + "&amp;TILEROW=" + '{y}' + "&amp;TILEMATRIX=" + '{z}';
        else
            urlTemplate = this.custom.baseURL + "?SERVICE=WMTS&amp;REQUEST=GetTile&amp;VERSION=" + this.custom.version + "&amp;LAYER=" + this.custom.layer + "&amp;STYLE=default&amp;TILEMATRIXSET=c&amp;FORMAT=tiles" + "&amp;TILECOL=" + '{x}' + "&amp;TILEROW=" + '{y}' + "&amp;TILEMATRIX=" + '{z}';
    } else {
        switch (this.layerType) {
            case Zondy.Enum.Map.TiandituType.VEC:
            case Zondy.Enum.TiandituType.VEC:
                urlTemplate = "http://t" + Math.round(Math.random() * 7) + ".tianditu.gov.cn/vec_c/wmts?SERVICE=WMTS&amp;REQUEST=GetTile&amp;VERSION=1.0.0&amp;LAYER=vec&amp;STYLE=default&amp;TILEMATRIXSET=c&amp;FORMAT=tiles" + "&amp;TILECOL=" + '{x}' + "&amp;TILEROW=" + '{y}' + "&amp;TILEMATRIX=" + '{z}';
                break;
            case Zondy.Enum.Map.TiandituType.IMG:
            case Zondy.Enum.TiandituType.IMG:
                urlTemplate = "http://t" + Math.round(Math.random() * 7) + ".tianditu.gov.cn/img_c/wmts?SERVICE=WMTS&amp;REQUEST=GetTile&amp;VERSION=1.0.0&amp;LAYER=img&amp;STYLE=default&amp;TILEMATRIXSET=c&amp;FORMAT=tiles" + "&amp;TILECOL=" + '{x}' + "&amp;TILEROW=" + '{y}' + "&amp;TILEMATRIX=" + '{z}';
                break;
            case Zondy.Enum.Map.TiandituType.CVA:
            case Zondy.Enum.TiandituType.CVA:
                urlTemplate = "http://t" + Math.round(Math.random() * 7) + ".tianditu.gov.cn/cva_c/wmts?SERVICE=WMTS&amp;REQUEST=GetTile&amp;VERSION=1.0.0&amp;LAYER=cva&amp;STYLE=default&amp;TILEMATRIXSET=c&amp;FORMAT=tiles" + "&amp;TILECOL=" + '{x}' + "&amp;TILEROW=" + '{y}' + "&amp;TILEMATRIX=" + '{z}';
                break;
            case Zondy.Enum.Map.TiandituType.CIA:
            case Zondy.Enum.TiandituType.CIA:
                urlTemplate = "http://t" + Math.round(Math.random() * 7) + ".tianditu.gov.cn/cia_c/wmts?SERVICE=WMTS&amp;REQUEST=GetTile&amp;VERSION=1.0.0&amp;LAYER=cia&amp;STYLE=default&amp;TILEMATRIXSET=c&amp;FORMAT=tiles" + "&amp;TILECOL=" + '{x}' + "&amp;TILEROW=" + '{y}' + "&amp;TILEMATRIX=" + '{z}';
                break;
            case Zondy.Enum.Map.TiandituType.VEC_IGS:
            case Zondy.Enum.TiandituType.VEC_IGS:
                urlTemplate = this.domainStr + "/igs/rest/cts/tianditu" + "/vector/" + '{x}' + "/" + '{y}' + "/" + '{z}';
                break;
            case Zondy.Enum.Map.TiandituType.IMG_IGS:
            case Zondy.Enum.TiandituType.IMG_IGS:
                urlTemplate = this.domainStr + "/igs/rest/cts/tianditu" + "/raster/" + '{x}' + "/" + '{y}' + "/" + '{z}';
                break;
            case Zondy.Enum.Map.TiandituType.CVA_IGS:
            case Zondy.Enum.TiandituType.CVA_IGS:
                urlTemplate = this.domainStr + "/igs/rest/cts/tianditu" + "/vectorAnno/" + '{x}' + "/" + '{y}' + "/" + '{z}';
                break;
            case Zondy.Enum.Map.TiandituType.CIA_IGS:
            case Zondy.Enum.TiandituType.CIA_IGS:
                urlTemplate = this.domainStr + "/igs/rest/cts/tianditu" + "/rasterAnno/" + '{x}' + "/" + '{y}' + "/" + '{z}';
                break;
        }
    }

    var token = "";
    if (this.token != undefined &amp;&amp; this.token != "") {
        token = "tk=" + this.token;
        if (urlTemplate.indexOf("?") > 0)
            urlTemplate += "&amp;" + token;
        else
            urlTemplate += "?" + token;
    }
    var z = tileCoord[0];
    var x = tileCoord[1];
    //var y = parseInt(Math.pow(2, z - 1) - 1 - tileCoord[2]);
    var y = -(tileCoord[2] + 1);
    return urlTemplate.replace('{x}', x.toString()).replace('{y}', y.toString()).replace('{z}', z.toString());
};

export {TiandituMapSource};
Zondy.Source.TiandituMapSource = TiandituMapSource;


/**
 * 显示天地图的功能服务
 * @class Zondy.Map.TianDiTu
 * @classdesc 显示天地图的功能服务构造函数
 * @description Zondy.Map.TianDiTu
 * @param option - {Object}  必选项，设置其他属性键值对对象。对象中的属性来自本类的属性。例如：{key1：value1, key2：value2 …}
 * @param {String} [option.token = ''] 必选项，天地图token，一定要去天地图网站申请。
 * @param {String} [option.layerType = ''] 必选项，图层类型。类型有：vec（天地图矢量数据）；img（
 天地图影像数据）；cva（天地图矢量注记数据）；cia（天地图影像注记数据）；vec_igs（天地图矢量数据(通过IGS)）；
 img_igs（天地图影像数据(通过IGS)）；cva_igs（天地图矢量注记数据(通过IGS)）；cia_igs（天地图影像注记数据(通过IGS)）
 * @param {Number[]} [option.extent = ''] 可选项，图层范围，如：[-180, -90, 180, 90]。
 * @param {Number[]} [option.origin = ''] 可选项，地图原点。默认左下角。
 * @param {Number} [option.minZoom = ''] 可选项，瓦片最小级数。
 * @param {Number} [option.maxZoom = ''] 可选项，瓦片最大级数。
 * @param {Number} [option.tileSize = ''] 可选项，地图图片大小。
 * @param {Number} [option.noWrap = ''] 可选项，地图是否连续显示。
 * @example
    var map;
    var tiandituLayer;
    //地图初始化函数
    function init() {
        map = new ol.Map({
            target: 'mapCon',
            view: new ol.View({
                projection: ol.proj.get('EPSG:4326'),
                center: [110, 30],
                maxZoom: 14,
                minZoom: 1,
                zoom: 4
            })
        });
        tiandituLayer = new Zondy.Map.TianDiTu({
            //图层类型
            layerType: 'vec',
            //最小显示等级
            minZoom: 0,
            //最大显示等级
            maxZoom: 15,
            //key
            token: "4c27d6e0e8a90715b23a989d42272fd8",
            //设置地图不连续显示
            noWrap: true
        });
        map.addLayer(tiandituLayer
        var tiandituLayer2 = new Zondy.Map.TianDiTu({
            //图层类型
            layerType: 'cva',
            //最小显示等级
            minZoom: 0,
            //最大显示等级
            maxZoom: 15,
            //key
            token: "4c27d6e0e8a90715b23a989d42272fd8",
            //设置地图不连续显示
            noWrap: true
        });
        map.addLayer(tiandituLayer2);
    }
 */
var TianDiTu = function (option) {
    var options = option !== undefined ? option : {};
    TileLayer.call(this, options);
    if (options.source == undefined) {
        this.source = new TiandituMapSource(options);
        this.setSource(this.source);
    }
};
inherits(TianDiTu, TileLayer);

export {TianDiTu};
Zondy.Map.TianDiTu = TianDiTu;

/**
 * @class Zondy.Source.GoogleMapSource
 * @classdesc 谷歌地图资源构造函数, extent(图层范围)必须设置，origin(瓦片原点)如果不赋值则默认取图层范围的左上角
 *
 * @param {Object} option 属性键值对
 * @param {String} [option.attributions = null] 基本描述内容
 * @param {String} [option.logo = null] 基本描述图标Logo
 * @param {String} [option.opaque = null] 不透明度
 * @param {String} [option.projection = null] ol.proj
 * @param {String} [option.state = undefined] 状态
 * @param {String} [option.tilePixelRatio = ] 瓦片的像素分辨率
 * @param {Boolean} [option.wrapX = false] 通过wrapX:false限制图层在x轴方向重复
 * @param {String} [option.crossOrigin = null] crossOrigin="anonymous"为跨域调用
 */
var GoogleMapSource = function (opt_options) {
    var options = opt_options !== undefined ? opt_options : {};
    TileImage.call(this, {
        attributions: options.attributions,
        logo: options.logo,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state !== undefined ? options.state : undefined,
        wrapX: options.wrapX,
        tilePixelRatio: options.tilePixelRatio,
        crossOrigin: options.crossOrigin !== undefined ? options.crossOrigin : null  //"anonymous"为跨域调用,
    });

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.ip
     * @type {String}
     * @description ip地址
     * @default null
     */
    this.ip = options.ip !== undefined ? options.ip : null;

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.port
     * @type {Number}
     * @description port端口号
     * @default null
     */
    this.port = options.port !== undefined ? options.port : null;

    /**
     * @public
     * @type {string}
     * 请求使用的网格协议，默认http协议
     */
    this.networkProtocol = options.networkProtocol !== undefined ? options.networkProtocol : location.protocol.split(":")[0] || "http";

    /**
     * @public
     * @type {string}
     * 请求使用的域名，基地址
     */
    this.domain = options &amp;&amp; options.domain ? options.domain : '';

    if (this.domain === '') {
        this.domainStr = this.networkProtocol + '://' + this.ip + ':' + this.port;
    } else {
        this.domainStr = this.domain;
    }

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.layerType
     * @type {GoogleLayerType}
     * @description layerType(图层类型)，默认情况下为"vector" {@link Zondy.Enum.Map.GoogleLayerType.VEC}
     * @default Zondy.Enum.Map.GoogleLayerType.VEC
     */
    this.layerType = options.layerType !== undefined ? options.layerType : Zondy.Enum.Map.GoogleLayerType.VEC;

    /**
     * @public
     * @member Zondy.Source.GoogleMapSource.prototype.maxResolution
     * @type {Number}
     * @description 最大分辨率,新瓦片必须指定
     * @default null
     */
    this.maxResolution = null;

    //根据投影获取地图范围
    var tileProjection = options.projection !== undefined ? options.projection : null;


    /**
     * @member Zondy.Source.GoogleMapSource.prototype.tileExtent
     * @type {Array}
     * @description 瓦片范围 [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892]
     * @default [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892]
     */
    this.tileExtent = [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892];
    if (tileProjection != null) {
        this.tileExtent = tileProjection.getExtent();
    }

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.extent
     * @type {Array}
     * @description 设置地图范围 options.extent 或者 this.tileExtent
     * @default this.tileExtent
     */
    this.extent = options.extent !== undefined ? options.extent : this.tileExtent;

    /**
     * @public
     * @member Zondy.Source.GoogleMapSource.prototype.origin
     * @type {Array}
     * @description 地图的原点，可由外部指定,默认左上角 Array&lt;Number> [0, 0]
     * @default ol_extent.getTopLeft(this.extent)
     */
    this.origin = options.origin !== undefined ? options.origin : ol_extent.getTopLeft(this.extent);

    /**
     * @public
     * @member Zondy.Source.GoogleMapSource.prototype.maxZoom
     * @type {Number}
     * @description 瓦片地图总级数
     * @default 24
     */
    this.maxZoom = options.maxZoom !== undefined ? (options.maxZoom &lt;= 24 ? options.maxZoom : 24) : 24;

    /**
     * @public
     * @member Zondy.Source.GoogleMapSource.prototype.tileSize
     * @type {Number}
     * @description 地图图片大小
     * @default 256
     */
    this.tileSize = options.tileSize !== undefined ? options.tileSize : 256;

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.resolutions
     * @type {Number}
     * @description 分辨率数组，根据传入的分辨率或范围计算得到
     * @see Zondy.Source.GoogleMapSource.prototype.getResolutions
     */
    this.resolutions = this.getResolutions();

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.baseURL
     * @type {String}
     * @description 基本Url地址
     * @see Zondy.Source.GoogleMapSource.prototype.getBaseURL
     */
    this.baseURL = options.baseURL !== undefined ? options.baseURL : this.getBaseURL();

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.tileGrid
     * @private
     * @type {Object}
     * @description 创建网格(内部调用){@link ol.TileGrid}
     * @example
     * this.tileGrid = new TileGrid({
            origin: this.origin, //数组类型，如[0,0],
            resolutions: this.resolutions, //分辨率
            tileSize: this.tileSize //瓦片图片大小
        });
     */
    this.tileGrid = new TileGrid({
        origin: this.origin, //数组类型，如[0,0],
        resolutions: this.resolutions, //分辨率
        tileSize: this.tileSize //瓦片图片大小
    });

    /**
     * @member Zondy.Source.GoogleMapSource.prototype.tileUrlFunction
     * @protected
     * @type {ol.TileUrlFunctionType}
     * @description 拼接取图地址方法
     * @default this.tileUrlFunctionExtend
     */
    this.tileUrlFunction = options.tileUrlFunction !== undefined ? options.tileUrlFunction : this.tileUrlFunctionExtend;

};
inherits(GoogleMapSource, TileImage);


/**
 * @function Zondy.Source.GoogleMapSource.prototype.getBaseURL
 * @description 创建基地址
 * @return {String} url_base 基地址
 */
GoogleMapSource.prototype.getBaseURL = function () {
    var url_base = "";
    switch (this.layerType) {
        case Zondy.Enum.Map.GoogleLayerType.VEC:
        case Zondy.Enum.GoogleLayerType.VEC:
            url_base = "http://mt" + Math.round(Math.random() * 3) + ".google.cn/vt/lyrs=m@207000000&amp;hl=zh-CN&amp;gl=CN&amp;src=app&amp;s=Galile";
            break;
        case Zondy.Enum.Map.GoogleLayerType.RASTER:
        case Zondy.Enum.GoogleLayerType.RASTER:
            url_base = "http://mt" + Math.round(Math.random() * 3) + ".google.cn/vt?lyrs=s@173&amp;hl=zh-Hans-CN&amp;gl=CN&amp;token=63145";
            break;
        case Zondy.Enum.Map.GoogleLayerType.ROAD:
        case Zondy.Enum.GoogleLayerType.ROAD:
            url_base = "http://mt" + Math.round(Math.random() * 3) + ".google.cn/vt/imgtp=png32&amp;lyrs=h@248000000,highlight:0x342eaef8dd85f26f:0x39c2c9ac6c582210@1%7Cstyle:maps&amp;hl=zh-CN&amp;gl=CN&amp;src=app&amp;s=Galileo";
            break;
        case Zondy.Enum.Map.GoogleLayerType.TERRAIN:
        case Zondy.Enum.GoogleLayerType.TERRAIN:
            // url_base = "http://mt" + Math.round(Math.random() * 3) + ".google.cn/vt/lyrs=t@132,r@248000000&amp;hl=zh-CN&amp;src=app&amp;s=Galileo";
            //url_base = "http://mt" + Math.round(Math.random() * 3) + ".google.cn/vt/lyrs=t@132,r@249000000&amp;hl=zh-CN&amp;src=app&amp;s=Galileo";
            url_base = "http://mt" + Math.round(Math.random() * 3) + ".google.cn/vt?lyrs=t&amp;scale=1";
            break;
        case Zondy.Enum.Map.GoogleLayerType.VEC_IGS:
        case Zondy.Enum.GoogleLayerType.VEC_IGS:
            url_base = this.domain + "/igs/rest/cts/google" + "/vector/";
            break;
        case Zondy.Enum.Map.GoogleLayerType.RASTER_IGS:
        case Zondy.Enum.GoogleLayerType.RASTER_IGS:
            url_base = this.domain + "/igs/rest/cts/google" + "/raster/";
            break;
        case Zondy.Enum.Map.GoogleLayerType.ROAD_IGS:
        case Zondy.Enum.GoogleLayerType.ROAD_IGS:
            url_base = this.domain + "/igs/rest/cts/google" + "/road/";
            break;
        case Zondy.Enum.Map.GoogleLayerType.TERRAIN_IGS:
        case Zondy.Enum.GoogleLayerType.TERRAIN_IGS:
            url_base = this.domain + "/igs/rest/cts/google" + "/terrain/";
            break;
    }
    return url_base;
};

/**
 * @function Zondy.Source.GoogleMapSource.prototype.getResolutions
 * @description 创建分辨率数组
 * @return {Array} opt_resolutions
 */
GoogleMapSource.prototype.getResolutions = function () {
    if (this.maxResolution == null) {
        var width = ol_extent.getWidth(this.tileExtent);
        var height = ol_extent.getHeight(this.tileExtent);
        this.maxResolution = (width &lt;= height ? height : width) / (this.tileSize);
    }
    var opt_resolutions = new Array(this.maxZoom);
    for (var z = 0; z &lt; this.maxZoom; ++z) {
        opt_resolutions[z] = this.maxResolution / Math.pow(2, z);
    }
    return opt_resolutions;
};

/**
 * @function Zondy.Source.GoogleMapSource.prototype.tileUrlFunctionExtend
 * @description 拼接url取图地址
 * @param {Array.&lt;number>} tileCoord 数据格式包含级数、行号、列号.
 * @param {String} pixelRatio 像素比率
 * @param {ol.proj.Projection} projection 投影
 * @return {String} 替换x-y-z后的url地址
 */
GoogleMapSource.prototype.tileUrlFunctionExtend = function (tileCoord, pixelRatio, projection) {
    //判断返回的当前级数的行号和列号是否包含在整个地图范围内
    if (this.tileGrid != null) {
        var tileRange = this.tileGrid.getTileRangeForExtentAndZ(this.extent, tileCoord[0], tileRange);
        if (!tileRange.contains(tileCoord)) {
            return;
        }
    }
    var urlTemplate = "";
    switch (this.layerType) {
        case Zondy.Enum.Map.GoogleLayerType.VEC:
        case Zondy.Enum.GoogleLayerType.VEC:
        case Zondy.Enum.Map.GoogleLayerType.RASTER:
        case Zondy.Enum.GoogleLayerType.RASTER:
        case Zondy.Enum.Map.GoogleLayerType.ROAD:
        case Zondy.Enum.GoogleLayerType.ROAD:
        case Zondy.Enum.Map.GoogleLayerType.TERRAIN:
        case Zondy.Enum.GoogleLayerType.TERRAIN:
            urlTemplate = this.baseURL + "&amp;x=" + '{x}' + "&amp;y=" + '{y}' + "&amp;z=" + '{z}';
            break;
        case Zondy.Enum.Map.GoogleLayerType.VEC_IGS:
        case Zondy.Enum.GoogleLayerType.VEC_IGS:
        case Zondy.Enum.Map.GoogleLayerType.RASTER_IGS:
        case Zondy.Enum.GoogleLayerType.RASTER_IGS:
        case Zondy.Enum.Map.GoogleLayerType.ROAD_IGS:
        case Zondy.Enum.GoogleLayerType.ROAD_IGS:
        case Zondy.Enum.Map.GoogleLayerType.TERRAIN_IGS:
        case Zondy.Enum.GoogleLayerType.TERRAIN_IGS:
            urlTemplate = this.baseURL + '{x}' + "/" + '{y}' + "/" + '{z}';
            break;
    }
    var z = tileCoord[0];
    var x = tileCoord[1];
    var y = -(tileCoord[2] + 1);
    //var y = Math.pow(2, z) - 1 - tileCoord[2];

    return urlTemplate.replace('{x}', x.toString()).replace('{y}', y.toString()).replace('{z}', z.toString());
};

export {GoogleMapSource};
Zondy.Source.GoogleMapSource = GoogleMapSource;

//**********************************************************Zondy.Source.GoogleMapSource(end)************************************************//
//**********************************************************Zondy.Map.GoogleLayer(start)************************************************//

/**
 * 显示谷歌地图的功能服务构造函数
 * @class Zondy.Map.GoogleLayer
 * @classdesc 显示谷歌地图的功能服务构造函数
 *
 * @param {Object} option 属性键值对
 * @param {Zondy.Source.GoogleMapSource} [option.source = null] openlayer的地图source
 */
var GoogleLayer = function (opt_options) {
    var options = opt_options !== undefined ? opt_options : {};
    TileLayer.call(this, options);
    if (options.source == undefined) {
        this.source = new GoogleMapSource(options);
        this.setSource(this.source);
    }
};
inherits(GoogleLayer, TileLayer);

export {GoogleLayer};
Zondy.Map.GoogleLayer = GoogleLayer;

/**
 * @class Zondy.Source.ArcGISMapSource
 * @classdesc ArcGIS地图资源构造函数, extent(图层范围)必须设置，origin(瓦片原点)如果不赋值则默认取图层范围的左上角
 *
 * @param {Object} option 属性键值对
 * @param {String} [option.attributions = null] 基本描述内容
 * @param {String} [option.logo = null] 基本描述图标Logo
 * @param {String} [option.opaque = null] 不透明度
 * @param {String} [option.projection = null] ol.proj
 * @param {String} [option.state = undefined] 状态
 * @param {String} [option.tilePixelRatio = ] 瓦片的像素分辨率
 * @param {Boolean} [option.wrapX = false] 通过wrapX:false限制图层在x轴方向重复
 * @param {String} [option.crossOrigin = null] crossOrigin="anonymous"为跨域调用
 */
var ArcGISMapSource = function (option) {
    var options = option !== undefined ? option : {};
    TileImage.call(this, {
        attributions: options.attributions,
        logo: options.logo,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state !== undefined ? options.state : undefined,
        tilePixelRatio: options.tilePixelRatio,
        wrapX: options.wrapX,
        crossOrigin: options.crossOrigin !== undefined ? options.crossOrigin : null  //"anonymous"为跨域调用,
    });

    /**
     * @member Zondy.Source.ArcGISMapSource.prototype.layerType
     * @type {ArcGISLayerType}
     * @description layerType(图层类型)，默认情况下为"World_Terrain_Base" {@link Zondy.Enum.Map.ArcGISLayerType.WorldTerrainBase}
     * @default Zondy.Enum.Map.ArcGISLayerType.WorldTerrainBase
     */
    this.layerType = options.layerType !== undefined ? options.layerType : Zondy.Enum.Map.ArcGISLayerType.WorldTerrainBase;

    /**
     * @public
     * @member Zondy.Source.ArcGISMapSource.prototype.maxResolution
     * @type {Number}
     * @description 最大分辨率,新瓦片必须指定
     * @default null
     */
    this.maxResolution = null;

    //根据投影获取地图范围
    var tileProjection = options.projection !== undefined ? options.projection : this.initProjection();

    /**
     * @member Zondy.Source.ArcGISMapSource.prototype.tileExtent
     * @type {Array}
     * @description 瓦片范围 [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892]
     * @default [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892]
     */
    this.tileExtent = [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892];
    if (tileProjection != null) {
        this.tileExtent = tileProjection.getExtent();
    }

    /**
     * @member Zondy.Source.ArcGISMapSource.prototype.extent
     * @type {Array}
     * @description 设置地图范围 options.extent 或者 this.tileExtent
     * @default this.tileExtent
     */
    this.extent = options.extent !== undefined ? options.extent : this.tileExtent;

    /**
     * @public
     * @member Zondy.Source.ArcGISMapSource.prototype.origin
     * @type {Array}
     * @description 地图的原点，可由外部指定,默认左上角 Array&lt;Number> [0, 0]
     * @default ol_extent.getTopLeft(this.extent)
     */
    this.origin = options.origin !== undefined ? options.origin : ol_extent.getBottomLeft(this.extent);

    /**
     * @public
     * @member Zondy.Source.ArcGISMapSource.prototype.maxZoom
     * @type {Number}
     * @description 瓦片地图总级数
     * @default 20
     */
    this.maxZoom = options.maxZoom !== undefined ? (options.maxZoom &lt;= 20 ? options.maxZoom : 20) : this.initMaxZoom();

    /**
     * @public
     * @member Zondy.Source.ArcGISMapSource.prototype.tileSize
     * @type {Number}
     * @description 地图图片大小
     * @default Zondy.Source.ArcGISMapSource.prototype.initTileSize
     */
    this.tileSize = options.tileSize !== undefined ? options.tileSize : this.initTileSize();

    /**
     * @member Zondy.Source.ArcGISMapSource.prototype.resolutions
     * @type {Number}
     * @description 分辨率数组，根据传入的分辨率或范围计算得到
     * @see Zondy.Source.ArcGISMapSource.prototype.getResolutions
     */
    this.resolutions = this.getResolutions();

    /**
     * @member Zondy.Source.ArcGISMapSource.prototype.baseURL
     * @type {String}
     * @description 基本Url地址
     * @default "http://services.arcgisonline.com/ArcGIS/rest/services/"
     */
    this.baseURL = options.baseURL !== undefined ? options.baseURL : "http://services.arcgisonline.com/ArcGIS/rest/services/";

    /**
     * @member Zondy.Source.ArcGISMapSource.prototype.tileGrid
     * @private
     * @type {Object}
     * @description 创建网格(内部调用){@link ol.TileGrid}
     * @example
     * this.tileGrid = new TileGrid({
            origin: this.origin, //数组类型，如[0,0],
            resolutions: this.resolutions, //分辨率
            tileSize: this.tileSize //瓦片图片大小
        });
     */
    this.tileGrid = new TileGrid({
        origin: this.origin, //数组类型，如[0,0],
        resolutions: this.resolutions, //分辨率
        tileSize: this.tileSize //瓦片图片大小
    });


    /**
     * @member Zondy.Source.ArcGISMapSource.prototype.tileUrlFunction
     * @protected
     * @type {ol.TileUrlFunctionType}
     * @description 拼接取图地址方法
     * @default this.tileUrlFunctionExtend
     */
    this.tileUrlFunction = options.tileUrlFunction !== undefined ? options.tileUrlFunction : this.tileUrlFunctionExtend;
};
inherits(ArcGISMapSource, TileImage);

/**
 * @function Zondy.Source.ArcGISMapSource.prototype.initTileSize
 * @description 初始化瓦片大小
 * @return {Number} tileSize 256
 */
ArcGISMapSource.prototype.initTileSize = function () {
    var tileSize = 256;
    //枚举Zondy.Enum.ArcGISLayerType是为了兼容OpenLayers2的写法
    switch (this.layerType) {
        case Zondy.Enum.Map.ArcGISLayerType.ImageryWorld2D:
        case Zondy.Enum.ArcGISLayerType.ImageryWorld2D:
        case Zondy.Enum.Map.ArcGISLayerType.StreetMapWorld2D:
        case Zondy.Enum.ArcGISLayerType.StreetMapWorld2D:
        case Zondy.Enum.Map.ArcGISLayerType.TopoUS2D:
        case Zondy.Enum.ArcGISLayerType.TopoUS2D:
            tileSize = 512;
            break;
        default:
            tileSize = 256;
            break;
    }
    return tileSize;
};

/**
 * @function Zondy.Source.ArcGISMapSource.prototype.initProjection
 * @description 初始化投影参照系
 * @return {ol_proj} ol_proj.get('EPSG:3857')
 */
ArcGISMapSource.prototype.initProjection = function () {
    var projection = null;
    switch (this.layerType) {
        case Zondy.Enum.Map.ArcGISLayerType.ImageryWorld2D:
        case Zondy.Enum.ArcGISLayerType.ImageryWorld2D:
        case Zondy.Enum.Map.ArcGISLayerType.StreetMapWorld2D:
        case Zondy.Enum.ArcGISLayerType.StreetMapWorld2D:
        case Zondy.Enum.Map.ArcGISLayerType.TopoUS2D:
        case Zondy.Enum.ArcGISLayerType.TopoUS2D:
            projection = ol_proj.get('EPSG:4326');
            break;
        default:
            projection = ol_proj.get('EPSG:3857');
            break;
    }
    return projection;
};

/**
 * @function Zondy.Source.ArcGISMapSource.prototype.initMaxZoom
 * @description 初始化最大级数
 * @return {Number} maxZoom
 */
ArcGISMapSource.prototype.initMaxZoom = function () {
    var maxZoom = null;
    switch (this.layerType) {
        case Zondy.Enum.Map.ArcGISLayerType.ImageryWorld2D:
        case Zondy.Enum.ArcGISLayerType.ImageryWorld2D:
        case Zondy.Enum.Map.ArcGISLayerType.StreetMapWorld2D:
        case Zondy.Enum.ArcGISLayerType.StreetMapWorld2D:
        case Zondy.Enum.Map.ArcGISLayerType.USATopoMaps:
        case Zondy.Enum.ArcGISLayerType.USATopoMaps:
            maxZoom = 16;
            break;
        case Zondy.Enum.Map.ArcGISLayerType.TopoUS2D:
        case Zondy.Enum.ArcGISLayerType.TopoUS2D:
        case Zondy.Enum.Map.ArcGISLayerType.WorldShadedRelief:
        case Zondy.Enum.ArcGISLayerType.WorldShadedRelief:
        case Zondy.Enum.Map.ArcGISLayerType.WorldTerrainBase:
        case Zondy.Enum.ArcGISLayerType.WorldTerrainBase:
            maxZoom = 14;
            break;
        case Zondy.Enum.Map.ArcGISLayerType.WorldPhysical:
        case Zondy.Enum.ArcGISLayerType.WorldPhysical:
            maxZoom = 9;
            break;
        case Zondy.Enum.Map.ArcGISLayerType.WorldStreet:
        case Zondy.Enum.ArcGISLayerType.WorldStreet:
        case Zondy.Enum.Map.ArcGISLayerType.WorldTopo:
        case Zondy.Enum.ArcGISLayerType.WorldTopo:
        case Zondy.Enum.Map.ArcGISLayerType.WorldImagery:
        case Zondy.Enum.ArcGISLayerType.WorldImagery:
            maxZoom = 20;
            break;
        case Zondy.Enum.Map.ArcGISLayerType.NatGeoWorldMap:
        case Zondy.Enum.ArcGISLayerType.NatGeoWorldMap:
        case Zondy.Enum.Map.ArcGISLayerType.OceanBasemap:
        case Zondy.Enum.ArcGISLayerType.OceanBasemap:
            maxZoom = 17;
            break;
    }
    return maxZoom;
};

/**
 * @function Zondy.Source.ArcGISMapSource.prototype.getResolutions
 * @description 创建分辨率数组
 * @return {Array} opt_resolutions
 */
ArcGISMapSource.prototype.getResolutions = function () {
    if (this.maxResolution == null) {
        var width = ol_extent.getWidth(this.tileExtent);
        var height = ol_extent.getHeight(this.tileExtent);
        this.maxResolution = (width >= height ? height : width) / (this.tileSize);
    }
    var opt_resolutions = new Array(this.maxZoom);
    for (var z = 0; z &lt; this.maxZoom; ++z) {
        opt_resolutions[z] = this.maxResolution / Math.pow(2, z);
    }
    return opt_resolutions;
};

/**
 * @function Zondy.Source.ArcGISMapSource.prototype.tileUrlFunctionExtend
 * @description 拼接url取图地址
 * @param {Array.&lt;number>} tileCoord 数据格式包含级数、行号、列号.
 * @param {String} pixelRatio 像素比率
 * @param {ol.proj.Projection} projection 投影
 * @return {String} 替换x-y-z后的url地址
 */
ArcGISMapSource.prototype.tileUrlFunctionExtend = function (tileCoord, pixelRatio, projection) {
    //判断返回的当前级数的行号和列号是否包含在整个地图范围内
    if (this.tileGrid != null) {
        var tileRange = this.tileGrid.getTileRangeForExtentAndZ(this.extent, tileCoord[0], tileRange);
        if (!tileRange.contains(tileCoord)) {
            return;
        }
    }
    var urlTemplate = this.baseURL + this.layerType + "/MapServer/tile/" + '{z}' + "/" + '{y}' + "/" + '{x}' + ".jpg";

    var z = tileCoord[0];
    var x = tileCoord[1];
    // var y = tileCoord[2];

    var y = Math.pow(2, z) - 1 - tileCoord[2];
    return urlTemplate.replace('{x}', x.toString()).replace('{y}', y.toString()).replace('{z}', z.toString());
};

export {ArcGISMapSource};
Zondy.Source.ArcGISMapSource = ArcGISMapSource;

/**
 * 显示ArcGIS地图的功能服务构造函数
 * @class Zondy.Map.ArcGISLayer
 * @classdesc 显示ArcGIS地图的功能服务构造函数
 *
 * @param {Object} option 属性键值对
 * @param {Zondy.Source.ArcGISMapSource} [option.source = null] openlayer的地图source
 */
var ArcGISLayer = function (option) {
    var options = option !== undefined ? option : {};
    TileLayer.call(this, options);
    if (options.source == undefined) {
        this.source = new ArcGISMapSource(options);
        this.setSource(this.source);
    }
};
inherits(ArcGISLayer, TileLayer);

export {ArcGISLayer};
Zondy.Map.ArcGISLayer = ArcGISLayer;

/**
 * @class Zondy.Source.OpenStreetMapSource
 * @classdesc OpenStreet地图资源构造函数, extent(图层范围)必须设置，origin(瓦片原点)如果不赋值则默认取图层范围的左上角
 *
 * @param {Object} option 属性键值对
 * @param {String} [option.attributions = null] 基本描述内容
 * @param {String} [option.logo = null] 基本描述图标Logo
 * @param {String} [option.opaque = null] 不透明度
 * @param {String} [option.projection = null] ol.proj
 * @param {String} [option.state = undefined] 状态
 * @param {String} [option.tilePixelRatio = ] 瓦片的像素分辨率
 * @param {Boolean} [option.wrapX = false] 通过wrapX:false限制图层在x轴方向重复
 * @param {String} [option.crossOrigin = null] crossOrigin="anonymous"为跨域调用
 */
var OpenStreetMapSource = function (option) {
    var options = option !== undefined ? option : {};

    TileImage.call(this, {
        attributions: options.attributions,
        logo: options.logo,
        opaque: options.opaque,
        projection: options.projection,
        state: options.state !== undefined ? options.state : undefined,
        tilePixelRatio: options.tilePixelRatio,
        wrapX: options.wrapX,
        crossOrigin: options.crossOrigin !== undefined ? options.crossOrigin : null  //"anonymous"为跨域调用,
    });

    /**
     * @member Zondy.Source.OpenStreetMapSource.prototype.layerType
     * @type {OpenStreetLayerType}
     * @description layerType(图层类型)，默认情况下为"openstreetmap" {@link Zondy.Enum.Map.OpenStreetLayerType.OSM}
     * @default Zondy.Enum.Map.OpenStreetLayerType.OSM
     */
    this.layerType = options.layerType !== undefined ? options.layerType : Zondy.Enum.Map.OpenStreetLayerType.OSM;

    /**
     * @public
     * @member Zondy.Source.OpenStreetMapSource.prototype.maxResolution
     * @type {Number}
     * @description 最大分辨率,新瓦片必须指定
     * @default null
     */
    this.maxResolution = null;

    //根据投影获取地图范围
    var tileProjection = options.projection !== undefined ? options.projxResolutionection : ol_proj.get('EPSG:3857');

    /**
     * @member Zondy.Source.OpenStreetMapSource.prototype.tileExtent
     * @type {Array}
     * @description 瓦片范围 [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892]
     * @default [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892]
     */
    this.tileExtent = [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892];
    if (tileProjection != null) {
        this.tileExtent = tileProjection.getExtent();
    }

    /**
     * @member Zondy.Source.OpenStreetMapSource.prototype.extent
     * @type {Array}
     * @description 设置地图范围 options.extent 或者 this.tileExtent
     * @default this.tileExtent
     */
    this.extent = options.extent !== undefined ? options.extent : this.tileExtent;

    /**
     * @public
     * @member Zondy.Source.OpenStreetMapSource.prototype.origin
     * @type {Array}
     * @description 地图的原点，可由外部指定,默认左下角 Array&lt;Number> [0, 0]
     * @default ol_extent.getBottomLeft(this.extent)
     */
    this.origin = options.origin !== undefined ? options.origin : ol_extent.getBottomLeft(this.extent);

    /**
     * @public
     * @member Zondy.Source.OpenStreetMapSource.prototype.maxZoom
     * @type {Number}
     * @description 瓦片地图总级数
     * @default 20
     */
    this.maxZoom = options.maxZoom !== undefined ? (options.maxZoom &lt;= 20 ? options.maxZoom : 20) : 20;

    /**
     * @public
     * @member Zondy.Source.OpenStreetMapSource.prototype.tileSize
     * @type {Number}
     * @description 地图图片大小
     * @default 256
     */
    this.tileSize = options.tileSize !== undefined ? options.tileSize : 256;

    /**
     * @member Zondy.Source.OpenStreetMapSource.prototype.resolutions
     * @type {Number}
     * @description 分辨率数组，根据传入的分辨率或范围计算得到
     * @see Zondy.Source.OpenStreetMapSource.prototype.getResolutions
     */
    this.resolutions = this.getResolutions();

    /**
     * @member Zondy.Source.OpenStreetMapSource.prototype.baseURL
     * @type {String}
     * @description 基本Url地址
     * @default Zondy.Source.OpenStreetMapSource.prototype.GetUrlFormat
     */
    this.baseURL = options.baseURL !== undefined ? options.baseURL : this.GetUrlFormat();

    /**
     * @member Zondy.Source.OpenStreetMapSource.prototype.tileGrid
     * @private
     * @type {Object}
     * @description 创建网格(内部调用){@link ol.TileGrid}
     * @example
     * this.tileGrid = new TileGrid({
            origin: this.origin, //数组类型，如[0,0],
            resolutions: this.resolutions, //分辨率
            tileSize: this.tileSize //瓦片图片大小
        });
     */
    this.tileGrid = new TileGrid({
        origin: this.origin, //数组类型，如[0,0],
        resolutions: this.resolutions, //分辨率
        tileSize: this.tileSize //瓦片图片大小
    });

    /**
     * @member Zondy.Source.OpenStreetMapSource.prototype.tileUrlFunction
     * @protected
     * @type {ol.TileUrlFunctionType}
     * @description 拼接取图地址方法
     * @default this.tileUrlFunctionExtend
     */
    this.tileUrlFunction = options.tileUrlFunction !== undefined ? options.tileUrlFunction : this.tileUrlFunctionExtend;

};
inherits(OpenStreetMapSource, TileImage);

/**
 * @function Zondy.Source.OpenStreetMapSource.prototype.GetUrlFormat
 * @description 获取取图地址的格式
 * @return {String} urlForMat
 */
OpenStreetMapSource.prototype.GetUrlFormat = function () {
    var urlForMat = null;
    var preIndex = "abc";
    switch (this.layerType) {
        case Zondy.Enum.Map.OpenStreetLayerType.LandScape:
        case Zondy.Enum.OpenStreetLayerType.LandScape:
            urlForMat = "http://" + preIndex[Math.round(Math.random() * 2)] + ".tile3.opencyclemap.org/landscape/{z}/{x}/{y}.png";
            break;
        case Zondy.Enum.Map.OpenStreetLayerType.CYCLE:
        case Zondy.Enum.OpenStreetLayerType.CYCLE:
            urlForMat = "http://" + preIndex[Math.round(Math.random() * 2)] + ".tile.opencyclemap.org/cycle/{z}/{x}/{y}.png";
            break;
        case Zondy.Enum.Map.OpenStreetLayerType.CycleTransport:
        case Zondy.Enum.OpenStreetLayerType.CycleTransport:
            urlForMat = "http://" + preIndex[Math.round(Math.random() * 2)] + ".tile2.opencyclemap.org/transport/{z}/{x}/{y}.png";
            break;
        case Zondy.Enum.Map.OpenStreetLayerType.OSM:
        case Zondy.Enum.OpenStreetLayerType.OSM:
            urlForMat = "http://" + preIndex[Math.round(Math.random() * 2)] + ".tile.openstreetmap.org/{z}/{x}/{y}.png";
            break;
        case Zondy.Enum.Map.OpenStreetLayerType.OSM_HYB:
        case Zondy.Enum.OpenStreetLayerType.OSM_HYB:
            urlForMat = "http://otile" + (Math.round(Math.random() * 2) + 1) + ".mqcdn.com/tiles/1.0.0/hyb/{z}/{x}/{y}.png";
            break;
        case Zondy.Enum.Map.OpenStreetLayerType.OSM_Quest:
        case Zondy.Enum.OpenStreetLayerType.OSM_Quest:
            urlForMat = "http://otile" + (Math.round(Math.random() * 2) + 1) + ".mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png";
            break;
        case Zondy.Enum.Map.OpenStreetLayerType.OSM_Q_SAT:
        case Zondy.Enum.OpenStreetLayerType.OSM_Q_SAT:
            urlForMat = "http://otile" + (Math.round(Math.random() * 2) + 1) + ".mqcdn.com/tiles/1.0.0/sat/{z}/{x}/{y}.jpg";
            break;
    }
    return urlForMat;
};

/**
 * @function Zondy.Source.OpenStreetMapSource.prototype.getResolutions
 * @description 创建分辨率数组
 * @return {Array} opt_resolutions
 */
OpenStreetMapSource.prototype.getResolutions = function () {
    if (this.maxResolution == null) {
        var width = ol_extent.getWidth(this.tileExtent);
        var height = ol_extent.getHeight(this.tileExtent);
        this.maxResolution = (width >= height ? height : width) / (this.tileSize);
    }
    var opt_resolutions = new Array(this.maxZoom);
    for (var z = 0; z &lt; this.maxZoom; ++z) {
        opt_resolutions[z] = this.maxResolution / Math.pow(2, z);
    }
    return opt_resolutions;
};

/**
 * @function Zondy.Source.OpenStreetMapSource.prototype.tileUrlFunctionExtend
 * @description 拼接url取图地址
 * @param {Array.&lt;number>} tileCoord 数据格式包含级数、行号、列号.
 * @param {String} pixelRatio 像素比率
 * @param {ol.proj.Projection} projection 投影
 * @return {String} 替换x-y-z后的url地址
 */
OpenStreetMapSource.prototype.tileUrlFunctionExtend = function (tileCoord, pixelRatio, projection) {
    //判断返回的当前级数的行号和列号是否包含在整个地图范围内
    if (this.tileGrid != null) {
        var tileRange = this.tileGrid.getTileRangeForExtentAndZ(this.extent, tileCoord[0], tileRange);
        if (!tileRange.contains(tileCoord)) {
            return;
        }
    }
    var z = tileCoord[0];
    var x = tileCoord[1];
    var y = Math.pow(2, z) - 1 - tileCoord[2];

    return this.baseURL.replace('{x}', x.toString()).replace('{y}', y.toString()).replace('{z}', z.toString());
};
export {OpenStreetMapSource};
Zondy.Source.OpenStreetMapSource = OpenStreetMapSource;

/**
 * 显示OpenStreet地图的功能服务构造函数
 * @class Zondy.Map.OpenStreetLayer
 * @classdesc 显示ArcGIS地图的功能服务构造函数
 *
 * @param {Object} option 属性键值对
 * @param {Zondy.Source.OpenStreetMapSource} [option.source = null] openlayer的地图source
 */
var OpenStreetLayer = function (option) {
    var options = option !== undefined ? option : {};
    TileLayer.call(this, options);
    if (options.source == undefined) {
        this.source = new OpenStreetMapSource(options);
        this.setSource(this.source);
    }
};
inherits(OpenStreetLayer, TileLayer);

export {OpenStreetLayer};
Zondy.Map.OpenStreetLayer = OpenStreetLayer;

/**
 * 天地图资源类型
 * @readonly
 * @enum {String}
 */
var TiandituType = {
    /** 天地图矢量数据 */
    VEC: 'vec',
    /** 天地图影像数据 */
    IMG: 'img',
    /** 天地图矢量注记数据 */
    CVA: 'cva',
    /** 天地图影像注记数据 */
    CIA: 'cia',
    /** 天地图矢量数据(通过IGS) */
    VEC_IGS: 'vec_igs',
    /** 天地图影像数据(通过IGS) */
    IMG_IGS: 'img_igs',
    /** 天地图矢量注记数据(通过IGS) */
    CVA_IGS: 'cva_igs',
    /** 天地图影像注记数据(通过IGS) */
    CIA_IGS: 'cia_igs'
};
export {TiandituType};
Zondy.Enum.Map.TiandituType = Zondy.Enum.TiandituType = TiandituType;

/**
 * 谷歌地图资源类型
 * @readonly
 * @enum {String}
 */
var GoogleLayerType = {
    /** Google矢量数据 */
    VEC: 'vector',
    /** Google影像数据 */
    RASTER: 'raster',
    /** Google道路数据 */
    ROAD: 'road',
    /** Google地形数据 */
    TERRAIN: 'terrain',
    /** Google矢量数据(通过IGS) */
    VEC_IGS: 'vector_igs',
    /** Google影像数据(通过IGS) */
    RASTER_IGS: 'raster_igs',
    /** Google道路数据(通过IGS) */
    ROAD_IGS: 'road_igs',
    /** Google地形数据(通过IGS) */
    TERRAIN_IGS: 'terrain_igs'
};
export {GoogleLayerType};
Zondy.Enum.Map.GoogleLayerType = Zondy.Enum.GoogleLayerType = GoogleLayerType;

/**
 * ArcGIS地图资源类型
 * @readonly
 * @enum {String}
 */
var ArcGISLayerType = {
    ImageryWorld2D: 'ESRI_Imagery_World_2D',
    StreetMapWorld2D: 'ESRI_StreetMap_World_2D',
    TopoUS2D: 'NGS_Topo_US_2D',
    WorldImagery: 'World_Imagery',
    WorldPhysical: 'World_Physical_Map',
    WorldShadedRelief: 'World_Shaded_Relief',
    WorldStreet: 'World_Street_Map',
    WorldTerrainBase: 'World_Terrain_Base',
    WorldTopo: 'World_Topo_Map',
    NatGeoWorldMap: 'NatGeo_World_Map',
    OceanBasemap: 'Ocean_Basemap',
    USATopoMaps: 'USA_Topo_Maps'
};
export {ArcGISLayerType};
Zondy.Enum.Map.ArcGISLayerType = Zondy.Enum.ArcGISLayerType = ArcGISLayerType;

/**
 * OpenStreet地图资源类型
 * @readonly
 * @enum {String}
 */
var OpenStreetLayerType = {
    LandScape: 'landscape',
    CYCLE: 'cycle',
    CycleTransport: 'transport',
    OSM: 'openstreetmap',
    OSM_HYB: 'hyb',
    OSM_Quest: 'mapquest',
    OSM_Q_SAT: 'OSM_sat'
};
export {OpenStreetLayerType};
Zondy.Enum.Map.OpenStreetLayerType = Zondy.Enum.OpenStreetLayerType = OpenStreetLayerType;



</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>文档生成<a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://www.smaryun.com" target="_blank">司马云</a> <span>© 2020 云生态圈</span>
                        <a href="http://develop.smaryun.com:8899/" target="_blank">MapGIS Client for JavaScript</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>

<script src="scripts/search.js"> </script>

</body>
</html>
